flowchart TD
  F0_1["로그인 실패 제한: 5회 연속 실패 시 점진적 잠금 (1분 → 5분 → 15분 → 30분)"]
  F0_2["2단계 인증 (2FA):"]
  F0_1_b2{"관리자 알림"}
  F0_2_b1{"SMS"}
  F0_2_b2{"TOTP"}
  F0_2_b3{"2FA 필수 대상"}
  F1_1["이메일 입력 → (인증 코드 발송) 버튼 클릭"]
  F1_2["이메일로 인증 코드 수신 (6자리, 5분 유효)"]
  F1_3["인증 코드 입력 → 검증"]
  F1_4["새 비밀번호 설정 (비밀번호 규칙 실시간 검증)"]
  F1_5["변경 완료 → 로그인 화면으로 리디렉트"]
  F0_1 --> F0_2
  F1_2 --> F1_3
  F1_3 --> F1_4
  F1_4 --> F1_5
  F0_2_b1 --> F0_2
  F0_2 --> F0_1_b2
  F0_2 --> F0_2_b2
  F0_2_b3 --> F0_1
  F1_5 --> F0_2_b2
  F0_1 --> F0_2_b1
  F0_1_b2 --> F0_2_b2
  F1_5 --> F0_2
  F1_4 --> F0_1_b2
  F0_2_b1 --> F1_5
  F1_1 --> F0_2_b3
  N1["새 노드"]
  N1 --> F1_2